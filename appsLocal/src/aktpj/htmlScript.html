<script>
 window.addEventListener("load",function(){
 document.getElementById("machinedata").style.display = "none";
},false);


/**
 * データベースより照合します
 *@pram{obj} フォームオブジェクト 
 *@return{void}
 */  
function SendForm(parentNode){
    document.getElementById("search").style.display = "none";
    var mgrn = parentNode.mgrn.value;
    google.script.run.withSuccessHandler(success).mydatabese(mgrn.toUpperCase());
    //document.getElementById("List").innerHTML = mgrn
    //return machineNumber
} 

/**
 * コールバック関数
 *@pram{String} 管理番号 
 *@return{void}
 */  
function success(mgrn){
  var json = JSON.parse(mgrn);
  if(json.auth == "nodata"){
    document.getElementById("machinedata").style.display = "block";
    document.getElementById("List").innerHTML = "ファイルがありませんフォームにデータを入力して下さい" 
  }else{
  var gas = JSON.stringify(json);
    document.getElementById("List").innerHTML = json.auth
    google.script.run.withSuccessHandler((function(res){
      document.main.btn.style.display = "block";
      document.getElementById("List").innerHTML = res ; 
    })).inspectionSheetEdit(gas);
  }
}

/**
 *フォームデータを登録する関数 
 * @pram{obj} フォームオブジェクト
 * @return{void}
 */
function dataAdd(formObj){
  var senddata = [];
  senddata.push(document.main.mgrn.value.toUpperCase());
  senddata.push(formObj.code.value.toUpperCase());
  senddata.push(formObj.mgth.value);
  senddata.push(formObj.abil.value);
  senddata.push(formObj.model.value);
  senddata.push("");
  senddata.push("");
  senddata.push("");
  senddata.push(formObj.serial.value);
  var json = JSON.stringify(senddata);
  //alert(formObj.code.value + mgrn)
  google.script.run.withSuccessHandler((function(){
  document.input.btn.style.display = "none";
  document.getElementById("List").innerHTML = "登録が完了しました<br>作成ボタンを押して下さい";
  document.getElementById("search").style.display = "block";
  document.getElementById("machinedata").style.display = "none";
  })()
  ).sheetDataAdd(json);

}



/**
 * 配列をテーブル形式に挿入
 *@pram{String[]} テーブル化する配列 
 *@return{void}
 */  

function insertJson(strArray){
 var json = JSON.parse(strArray);
 var contents = tablefunc(json);
 document.getElementById("List").innerHTML = contents;
 }

function tablefunc(dataArray) {
 var content = "<table class='type08'><thead><tr>"
              + "<th>ファイル名</th>"
              + "</tr></thead><tbody>";  
  for(var i = 0;i<dataArray.length;i++){ 
    content = content + "<tr>";
    content = content + "<th scope='row'><b>" + dataArray[i] + "</b></th>";
    content = content + "</tr>";
  }
  content = content + "</tbody></table><body>";      
  return content
}

</script>

